# Цели преобразования кодировок символов в приложении

Современные приложения довольно часть осуществляют взаимодействие с другими системами. В каких-то случаях такое взаимодействие осуществляется через сетевое соединение, в каких-то используется подключаемые библиотеки. При этом кодировки передаваемых текстовых данных могут быть принципиально разными. Так, например, приложение должно запросить у интеграционного сервиса (web API) список назначений платежа и сервис возвращает текстовые названия в кодировке UTF16 (двух байтовая). После выбора назначения платежа пользователем, приложением должно передать информацию о конкретном назначени платежа в ядру платёжной системы, которое работает в кодировке CodePage1251 (одно байтовая).

При ответственном подходе, приложение использует только одну кодировку текстовых значений в своих собственных компонентах, а при взаимодействии с другими компонентами осуществляет перекодирование в/из формат(а) целевого компонента. Таким образом, преобразование текста осуществляется только на "границах" системы, что позволяет избежать ошибок отсутствия должны кодировок, или лишних многогратных перекодировок текста.

Перед началом разработки кода программист должен принять решение о кодировке, принятой в самом приложении. Например, в ПроАТМ такой кодировкой является UTF8.

Вспомогательная библиотека ConvertUTF используется для того, чтобы обеспечить перекодирование форматов текста на границе между внутренними компонентами ПроАТМ и внешними компонентами.

## Что имеет смысл тестировать

Основная функция библиотеки конвертация текстов. В общем случае, конвертация может сбоить в тех случаех, когда происходит потеря информации о языке, закодированном в текстовой строке. Типовые тесты:

- Входная строка является UTF16 и содержит кириллические символы. Текущая **locale** - символы русского языка. Выходная строка - CodePage1251
- Входная строка является UTF16 и содержит как китайские иероглифы, так и текст на иврите. Кодировка должна осуществляться в UTF8, а затем из UTF8 в UTF16. После двойного преобразования, оригинальная и преобразованная строка должны быть эквивалентными
- Используя подход "буфер внутри буфера" добавить во внешнем буфере "маркеры неизменности" (например, байты с кодом 0xCC) выполнить типовые операции преобразования двух байтовых последовательностей в одно байтовые и обратно. "Маркеры неизменности" должны оставаться без изменений

## Вопросы быстродействия

Для достижения максимально эффективного использования вычислительных ресурсов следует обратить внимание на следующие вопросы:

- В какой кодировке эффективнее всего осуществляется поиск символа/строки (предположительно, в UTF8 поиск должен быть самым медленным)?
- Какая кодировка занимает минимальный объём памяти (ОЗУ)?
- Какие преобразования являются наиболее медленными?
- Как выделение дополнительных буферов для результатов кодирования влияет на производительность?
- Можно ли использовать буфера для преобразования повторно?
