# Использование gRPC

gRPC применяется чаще всего как инструмент взаимодействия между микросервисами в соответсвующей архитектуре. gRPC часто противопоставляют JSON.

Недостатки JSON:

- динамическая схема, т.е. структура документа может меняться произвольным образом
- parsing документа медленный
- отсутствие типизации
- относительно большой размер данных

Protobuf, являющийся одним из уровней gRPC пытается компенсировать эти недостатки, включая строгую схему данных.

## Типы данных Protobuf

Основные типы данных Protobuf:

- double/float
- int32/int64
- uint32/uint64
- sint32/sint64 - оптимизация для преимущественно отрицательных чисел
- fixed32/fixed64 - оптимизация для больших чисел, с большим количеством нулей в конце (10 в степени N)
- bool, string, bytes
- google nullable type - особый тип, который может быть nullable

Так же при определении типа может использоваться модификатор repeated, который означает динамический массив. Для понимания: list, vector, slice.

Пример сообщения:

```grpc
message InfoResponse {
    int32 id = 1;
    int32 moderator_id = 2;
    repeated int64 task_ids = 3;
}
```

Числа с правой части определения - это порядковый номер поля в сообщении.

В определении сообщений могут быть использованы enum-ы:

```grpc
enum ContentType {
    POST = 1;
    COMMENT = 1;
    reserved 2 to 7;
    STREAM = 8;
}
```

Хорошей практикой является определение значения с индексом 0, например: `UNKNOWN=0`.
